{
  "type": "log",
  "x": 0,
  "y": 12,
  "width": 12,
  "height": 6,
  "properties": {
    "query": "SOURCE '${WebhookRedeliveryLogGroupName}'\n| filter metric_type = \"webhook_redelivery_summary\"\n| stats sum(deliveries_redelivered) as TotalRedelivered, sum(deliveries_failed) as TotalFailed, sum(deliveries_scanned) as TotalScanned by bin(5m)\n| sort @timestamp desc",
    "region": "${AWS::Region}",
    "title": "Webhook Redeliveries (Last 24h)",
    "view": "table",
    "stacked": false
  }
}

# Alternative time series widget for showing redeliveries over time
{
  "type": "log",
  "x": 12,
  "y": 12,
  "width": 12,
  "height": 6,
  "properties": {
    "query": "SOURCE '${WebhookRedeliveryLogGroupName}'\n| filter metric_type = \"webhook_redelivery_summary\"\n| stats sum(deliveries_redelivered) as Redelivered by bin(5m)\n| sort @timestamp",
    "region": "${AWS::Region}",
    "title": "Webhook Redeliveries Over Time",
    "view": "timeSeries",
    "stacked": false
  }
}

# Widget for recent individual webhook redeliveries
{
  "type": "log",
  "x": 0,
  "y": 18,
  "width": 24,
  "height": 6,
  "properties": {
    "query": "SOURCE '${WebhookRedeliveryLogGroupName}'\n| filter metric_type = \"webhook_redelivery_success\"\n| fields @timestamp, delivery_id, event, action, original_status_code\n| sort @timestamp desc\n| limit 20",
    "region": "${AWS::Region}",
    "title": "Recent Webhook Redeliveries",
    "view": "table"
  }
}